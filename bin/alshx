#!/bin/sh

URL=https://alshdavid.github.io/sh
Q="q=$(openssl rand -base64 12)"

if [ -z "$1" ] ; then
    echo "Please include script"
    exit 1
fi

if [ $1 = "--upgrade" ] || [ $1 = "-u" ] || [ $1 = "--update" ] ; then
    BASEDIR=$(dirname "$0")
    wget $URL/bin/alshx?$Q -O $BASEDIR/alshx
    chmod +x $BASEDIR/alshx
    exit 0
fi

if [ $1 = "--list" ] || [ $1 = "-ls" ] || [ $1 = ".index" ] ; then
    curl -s $URL/scripts/~list
    exit 0
fi

SCRIPT=$1
ARGS=""
i=0
for ARG in "$@"
do
    if [ "$i" != 0 ]
    then
        ARGS="$ARGS $ARG"
    fi
    i=$(( $i + 1 ))
done

curl -s -f $URL/scripts/$SCRIPT.sh?$Q | sh /dev/stdin $ARGS
