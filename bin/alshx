#!/bin/sh
BASEDIR=$(dirname "$0")
URL=https://alshdavid.github.io/alshx
Q="q=$(openssl rand -base64 12)"

if [ -z "$1" ] ; then
    echo "Please include script"
    exit 1
fi

if [ $1 = "--install" ] || [ $1 = "-i" ] ; then
    echo $SCRIPTS_AUTH
    curl -o $2/alshx $URL/bin/alshx?$Q
    chmod +x $2/alshx
    exit 0
fi

if [ $1 = "--upgrade" ] || [ $1 = "-u" ] || [ $1 = "--update" ] ; then
    curl -o $BASEDIR/alshx $URL/bin/alshx?$Q
    chmod +x $BASEDIR/alshx
    exit 0
fi

SCRIPT=$1
ARGS=""
i=0
for ARG in "$@"
do
    if [ "$i" != 0 ]
    then
        ARGS="$ARGS $ARG"
    fi
    i=$(( $i + 1 ))
done

curl -s -f $URL/scripts/$SCRIPT.sh?$Q | bash /dev/stdin $ARGS
